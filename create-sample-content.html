<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>サンプルコンテンツ作成</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto; padding: 2rem; }
        .form-group { margin-bottom: 1rem; }
        label { display: block; margin-bottom: 0.5rem; font-weight: bold; }
        input, textarea { width: 100%; padding: 0.5rem; border: 1px solid #ddd; border-radius: 4px; }
        textarea { height: 100px; }
        button { background: #2276fc; color: white; padding: 0.75rem 1.5rem; border: none; border-radius: 4px; cursor: pointer; }
        button:hover { background: #1e5dd6; }
        .success { color: green; margin-top: 1rem; }
        .error { color: red; margin-top: 1rem; }
    </style>
</head>
<body>
    <h1>ブログ記事を作成</h1>
    <p>Sanity Studioの代わりに、この簡単なフォームでブログ記事を作成できます。</p>
    
    <form id="post-form">
        <div class="form-group">
            <label for="title">記事タイトル</label>
            <input type="text" id="title" name="title" required placeholder="例: 初めてのブログ記事">
        </div>
        
        <div class="form-group">
            <label for="slug">URL slug</label>
            <input type="text" id="slug" name="slug" required placeholder="例: first-blog-post">
        </div>
        
        <div class="form-group">
            <label for="excerpt">要約</label>
            <textarea id="excerpt" name="excerpt" placeholder="記事の簡単な要約を書いてください"></textarea>
        </div>
        
        <div class="form-group">
            <label for="content">記事内容</label>
            <textarea id="content" name="content" required placeholder="記事の本文を書いてください"></textarea>
        </div>
        
        <button type="submit">記事を作成</button>
    </form>
    
    <div id="result"></div>
    
    <hr style="margin: 2rem 0;">
    
    <p><a href="blog.html">ブログページを見る</a></p>

    <script src="https://cdn.jsdelivr.net/npm/@sanity/client@6.4.12/dist/sanity.min.js"></script>
    <script>
        // Sanityクライアントの設定
        const client = new SanityClient({
            projectId: 'cejunzr5',
            dataset: 'production',
            apiVersion: '2023-01-01',
            useCdn: false,
            token: 'skfQzCEojDtTZdVIOnjWUFDQcNtPnKO92T21INzUMvocapPuZmu8WheYx2VEMLCAAUbg5m8XThTUjR2sJVTCpH4plNaorO5G8pIEQB9J6zbVg1ABnDDtGkx5pqykvY1m61CDx8uBP1EvVuukWz7LvrDDRyubC8VJRAWk0VtRyXgALYBB5uKt'
        });

        document.getElementById('post-form').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const formData = new FormData(e.target);
            const postData = {
                _type: 'post',
                title: formData.get('title'),
                slug: {
                    _type: 'slug',
                    current: formData.get('slug')
                },
                excerpt: formData.get('excerpt'),
                body: [
                    {
                        _type: 'block',
                        children: [
                            {
                                _type: 'span',
                                text: formData.get('content')
                            }
                        ]
                    }
                ],
                publishedAt: new Date().toISOString()
            };

            const resultDiv = document.getElementById('result');
            resultDiv.innerHTML = '<p>作成中...</p>';

            try {
                // 注意: この機能を使うにはAPIトークンが必要です
                const result = await client.create(postData);
                resultDiv.innerHTML = '<p class="success">記事が作成されました！ <a href="blog.html">ブログページで確認する</a></p>';
            } catch (error) {
                console.error('Error:', error);
                resultDiv.innerHTML = `
                    <p class="error">記事の作成に失敗しました。</p>
                    <p>APIトークンが設定されていないか、権限が不足している可能性があります。</p>
                    <p>Sanity Studioを使用するか、以下の手順で設定してください：</p>
                    <ol>
                        <li>Sanityの管理画面で「API」タブに移動</li>
                        <li>「Add API token」をクリック</li>
                        <li>「Editor」権限でトークンを作成</li>
                        <li>このページのコードでトークンを設定</li>
                    </ol>
                `;
            }
        });

        // スラッグの自動生成
        document.getElementById('title').addEventListener('input', (e) => {
            const title = e.target.value;
            const slug = title
                .toLowerCase()
                .replace(/[^\w\s-]/g, '')
                .replace(/\s+/g, '-')
                .replace(/-+/g, '-')
                .trim();
            document.getElementById('slug').value = slug;
        });
    </script>
</body>
</html>